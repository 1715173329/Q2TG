// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Message {
  id         Int      @id @default(autoincrement())
  qqRoomId   Int
  qqSenderId Int
  time       Int
  brief      String
  seq        Int
  rand       Int
  pktnum     Int
  tgChatId   Int
  tgMsgId    Int

  @@unique([qqRoomId, qqSenderId, seq, rand, pktnum, time])
  @@unique([tgChatId, tgMsgId])
}

model ForwardPair {
  id          Int           @id @default(autoincrement())
  qqRoomId    Int           @unique
  tgChatId    Int           @unique
  AvatarCache AvatarCache[]
}

model File {
  id      Int    @id @default(autoincrement())
  roomId  Int
  fileId  String
  info    String

  @@unique([roomId, fileId])
}

model FlashPhoto {
  id       Int    @id @default(autoincrement())
  photoMd5 String
}

model FlashPhotoView {
  id           Int @id @default(autoincrement())
  flashPhotoId Int
  viewerId     Int

  @@unique([flashPhotoId, viewerId])
}

model AvatarCache {
  id            Int         @id @default(autoincrement())
  forwardPair   ForwardPair @relation(fields: [forwardPairId], references: [id])
  forwardPairId Int         @unique
  hash          String
}
